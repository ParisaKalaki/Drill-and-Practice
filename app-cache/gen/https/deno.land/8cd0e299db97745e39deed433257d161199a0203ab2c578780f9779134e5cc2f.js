export default class SqliteStore {
    db;
    tableName;
    constructor(db, tableName = 'sessions'){
        this.db = db;
        this.tableName = tableName;
        this.db.query(`CREATE TABLE IF NOT EXISTS ${this.tableName} (id TEXT, data TEXT)`);
    }
    sessionExists(sessionId) {
        let session = '';
        for (const [sess] of this.db.query(`SELECT data FROM ${this.tableName} WHERE id = ?`, [
            sessionId
        ])){
            session = sess;
        }
        return session ? true : false;
    }
    getSessionById(sessionId) {
        let session = '';
        for (const [sess] of this.db.query(`SELECT data FROM ${this.tableName} WHERE id = ?`, [
            sessionId
        ])){
            session = sess;
        }
        return session ? JSON.parse(session) : null;
    }
    createSession(sessionId, initialData) {
        this.db.query(`INSERT INTO ${this.tableName} (id, data) VALUES (?, ?)`, [
            sessionId,
            JSON.stringify(initialData)
        ]);
    }
    deleteSession(sessionId) {
        this.db.query(`DELETE FROM ${this.tableName} WHERE id = ?`, [
            sessionId
        ]);
    }
    persistSessionData(sessionId, sessionData) {
        this.db.query(`UPDATE ${this.tableName} SET data = ? WHERE id = ?`, [
            JSON.stringify(sessionData),
            sessionId
        ]);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3gvb2FrX3Nlc3Npb25zQHY0LjEuOS9zcmMvc3RvcmVzL1NxbGl0ZVN0b3JlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERCIH0gZnJvbSBcImh0dHBzOi8vZGVuby5sYW5kL3gvc3FsaXRlQHYzLjQuMC9tb2QudHNcIlxuaW1wb3J0IFN0b3JlIGZyb20gJy4vU3RvcmUudHMnXG5pbXBvcnQgeyBTZXNzaW9uRGF0YSB9IGZyb20gJy4uL1Nlc3Npb24udHMnXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNxbGl0ZVN0b3JlIGltcGxlbWVudHMgU3RvcmUge1xuICBkYjogREJcbiAgdGFibGVOYW1lOiBzdHJpbmdcblxuICBjb25zdHJ1Y3RvcihkYiA6IERCLCB0YWJsZU5hbWUgPSAnc2Vzc2lvbnMnKSB7XG4gICAgdGhpcy5kYiA9IGRiXG4gICAgdGhpcy50YWJsZU5hbWUgPSB0YWJsZU5hbWVcbiAgICB0aGlzLmRiLnF1ZXJ5KGBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyAke3RoaXMudGFibGVOYW1lfSAoaWQgVEVYVCwgZGF0YSBURVhUKWApXG4gIH1cblxuICBzZXNzaW9uRXhpc3RzKHNlc3Npb25JZCA6IHN0cmluZykge1xuICAgIGxldCBzZXNzaW9uID0gJydcbiAgICBcbiAgICBmb3IgKGNvbnN0IFtzZXNzXSBvZiB0aGlzLmRiLnF1ZXJ5PHN0cmluZ1tdPihgU0VMRUNUIGRhdGEgRlJPTSAke3RoaXMudGFibGVOYW1lfSBXSEVSRSBpZCA9ID9gLCBbc2Vzc2lvbklkXSkpIHtcbiAgICAgIHNlc3Npb24gPSBzZXNzXG4gICAgfVxuXG4gICAgcmV0dXJuIHNlc3Npb24gPyB0cnVlIDogZmFsc2U7XG4gIH1cblxuICBnZXRTZXNzaW9uQnlJZChzZXNzaW9uSWQgOiBzdHJpbmcpIHtcbiAgICBsZXQgc2Vzc2lvbiA9ICcnXG4gICAgXG4gICAgZm9yIChjb25zdCBbc2Vzc10gb2YgdGhpcy5kYi5xdWVyeTxzdHJpbmdbXT4oYFNFTEVDVCBkYXRhIEZST00gJHt0aGlzLnRhYmxlTmFtZX0gV0hFUkUgaWQgPSA/YCwgW3Nlc3Npb25JZF0pKSB7XG4gICAgICBzZXNzaW9uID0gc2Vzc1xuICAgIH1cblxuICAgIHJldHVybiBzZXNzaW9uID8gSlNPTi5wYXJzZShzZXNzaW9uKSBhcyBTZXNzaW9uRGF0YSA6IG51bGw7XG4gIH1cblxuICBjcmVhdGVTZXNzaW9uKHNlc3Npb25JZCA6IHN0cmluZywgaW5pdGlhbERhdGEgOiBTZXNzaW9uRGF0YSkge1xuICAgIHRoaXMuZGIucXVlcnkoYElOU0VSVCBJTlRPICR7dGhpcy50YWJsZU5hbWV9IChpZCwgZGF0YSkgVkFMVUVTICg/LCA/KWAsIFtzZXNzaW9uSWQsIEpTT04uc3RyaW5naWZ5KGluaXRpYWxEYXRhKV0pO1xuICB9XG5cbiAgZGVsZXRlU2Vzc2lvbihzZXNzaW9uSWQgOiBzdHJpbmcpIHtcbiAgICB0aGlzLmRiLnF1ZXJ5KGBERUxFVEUgRlJPTSAke3RoaXMudGFibGVOYW1lfSBXSEVSRSBpZCA9ID9gLCBbc2Vzc2lvbklkXSlcbiAgfVxuXG4gIHBlcnNpc3RTZXNzaW9uRGF0YShzZXNzaW9uSWQgOiBzdHJpbmcsIHNlc3Npb25EYXRhIDogU2Vzc2lvbkRhdGEpIHtcbiAgICB0aGlzLmRiLnF1ZXJ5KGBVUERBVEUgJHt0aGlzLnRhYmxlTmFtZX0gU0VUIGRhdGEgPSA/IFdIRVJFIGlkID0gP2AsIFtcbiAgICAgIEpTT04uc3RyaW5naWZ5KHNlc3Npb25EYXRhKSwgc2Vzc2lvbklkXG4gICAgXSk7XG4gIH1cbn0iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBSUEsZUFBZSxNQUFNO0lBQ25CLEdBQU07SUFDTixVQUFpQjtJQUVqQixZQUFZLEVBQU8sRUFBRSxZQUFZLFVBQVUsQ0FBRTtRQUMzQyxJQUFJLENBQUMsRUFBRSxHQUFHO1FBQ1YsSUFBSSxDQUFDLFNBQVMsR0FBRztRQUNqQixJQUFJLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLDJCQUEyQixFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMscUJBQXFCLENBQUM7SUFDbkY7SUFFQSxjQUFjLFNBQWtCLEVBQUU7UUFDaEMsSUFBSSxVQUFVO1FBRWQsS0FBSyxNQUFNLENBQUMsS0FBSyxJQUFJLElBQUksQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFXLENBQUMsaUJBQWlCLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsRUFBRTtZQUFDO1NBQVUsRUFBRztZQUM1RyxVQUFVO1FBQ1o7UUFFQSxPQUFPLFVBQVUsSUFBSSxHQUFHLEtBQUs7SUFDL0I7SUFFQSxlQUFlLFNBQWtCLEVBQUU7UUFDakMsSUFBSSxVQUFVO1FBRWQsS0FBSyxNQUFNLENBQUMsS0FBSyxJQUFJLElBQUksQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFXLENBQUMsaUJBQWlCLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsRUFBRTtZQUFDO1NBQVUsRUFBRztZQUM1RyxVQUFVO1FBQ1o7UUFFQSxPQUFPLFVBQVUsS0FBSyxLQUFLLENBQUMsV0FBMEIsSUFBSTtJQUM1RDtJQUVBLGNBQWMsU0FBa0IsRUFBRSxXQUF5QixFQUFFO1FBQzNELElBQUksQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMseUJBQXlCLENBQUMsRUFBRTtZQUFDO1lBQVcsS0FBSyxTQUFTLENBQUM7U0FBYTtJQUNsSDtJQUVBLGNBQWMsU0FBa0IsRUFBRTtRQUNoQyxJQUFJLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLFlBQVksRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxFQUFFO1lBQUM7U0FBVTtJQUN6RTtJQUVBLG1CQUFtQixTQUFrQixFQUFFLFdBQXlCLEVBQUU7UUFDaEUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQywwQkFBMEIsQ0FBQyxFQUFFO1lBQ2xFLEtBQUssU0FBUyxDQUFDO1lBQWM7U0FDOUI7SUFDSDtBQUNGLENBQUMifQ==